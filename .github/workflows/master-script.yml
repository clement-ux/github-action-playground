name: Counter Script `increment()`

on:
  # Trigger via AWS EventBridge (Webhook)
  repository_dispatch:
    types: [run-foundry-script]
  
  # Manual trigger (GitHub Button) for easy testing
  workflow_dispatch:
    inputs:
      number_value:
        description: 'Numeric value to use in the script'
        required: true

jobs:
  execute:
    runs-on: ubuntu-latest
    environment: Test
    steps:
      - uses: actions/checkout@v4
        with:
          submodules: recursive

      - name: Install Foundry
        uses: foundry-rs/foundry-toolchain@v1
        with:
          version: "stable"

      - name: Install Dependencies
        run: 	forge install
      
      - name: Run Dynamic Script
        run: |
          echo "ðŸš€ Launching script: CounterInteraction"
          
          forge script script/CounterInteraction.s.sol \
            --rpc-url ${{ secrets.RPC_URL }} \
            --private-key ${{ secrets.PRIVATE_KEY }} \
            --broadcast \
            -vvvvv

        env:
            NUMBER_VALUE: ${{ github.event.inputs.number_value }}
