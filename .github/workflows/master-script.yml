name: Counter Script `increment()`

on:
  # D√©clencheur via AWS EventBridge (Webhook)
  repository_dispatch:
    types: [run-foundry-script]
  
  # D√©clencheur manuel (Bouton GitHub) pour tester facilement
  workflow_dispatch:
    inputs:
      number_value:
        description: 'Valeur num√©rique √† utiliser dans le script'
        required: true
      extra_args:
        description: 'Arguments suppl√©mentaires'
        required: false

jobs:
  execute:
    runs-on: ubuntu-latest
    environment: Test
    steps:
      - uses: actions/checkout@v4
        with:
          submodules: recursive

      - name: Install Foundry
        uses: foundry-rs/foundry-toolchain@v1
        with:
          version: "stable"

      - name: Install Dependencies
        run: 	forge install
      
      - name: Run Dynamic Script
        run: |
          # Petite astuce pour g√©rer soit le d√©clencheur AWS, soit le manuel
          
          echo "üöÄ Lancement du script: CounterInteraction"
          
          forge script script/CounterInteraction.s.sol \
            --rpc-url ${{ secrets.RPC_URL }} \
            --private-key ${{ secrets.PRIVATE_KEY }} \
            --broadcast \

        env:
            NUMBER_VALUE: ${{ github.event.inputs.number_value }}